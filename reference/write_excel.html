<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Write Excel tables — write_excel • MutSeqR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Write Excel tables — write_excel"><meta name="description" content="Writes data to an Excel file."><meta property="og:description" content="Writes data to an Excel file."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MutSeqR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/MutSeqR_introduction.html">Overview of MutSeqR workflow</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EHSRB-BSRSE-Bioinformatics/MutSeqR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Write Excel tables</h1>
      <small class="dont-index">Source: <a href="https://github.com/EHSRB-BSRSE-Bioinformatics/MutSeqR/blob/main/R/write_nice_excel.R" class="external-link"><code>R/write_nice_excel.R</code></a></small>
      <div class="d-none name"><code>write_excel.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Writes data to an Excel file.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">write_excel</span><span class="op">(</span><span class="va">data</span>, output_path <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">workbook_name</span>, model_results <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame or a list of data frames. If a data frame,
it will be written to a single sheet in the Excel workbook. If a list, each
data frame will be written to a separate sheet in the Excel workbook.
Data may also be the output to model_mf, in which case set
<code>model_results = TRUE</code>.</p></dd>


<dt id="arg-output-path">output_path<a class="anchor" aria-label="anchor" href="#arg-output-path"></a></dt>
<dd><p>The directory where the Excel file should be written.
Default is NULL, which will write the file to the current working directory.</p></dd>


<dt id="arg-workbook-name">workbook_name<a class="anchor" aria-label="anchor" href="#arg-workbook-name"></a></dt>
<dd><p>The file name for the Excel file.</p></dd>


<dt id="arg-model-results">model_results<a class="anchor" aria-label="anchor" href="#arg-model-results"></a></dt>
<dd><p>A logical value indicating whether the data is the
output of model_mf. Default is FALSE. If TRUE, the function will grab the
model_data, point_estimates, and pairwise_comparisons data frames from the
model_mf output and write them to separate sheets in the Excel workbook.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A saved Excel workbook.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">example_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Example_files"</span>,</span></span>
<span class="r-in"><span>                            <span class="st">"example_mutation_data_filtered.rds"</span>,</span></span>
<span class="r-in"><span>                            package <span class="op">=</span> <span class="st">"MutSeqR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">example_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="va">example_file</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mf1</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_mf.html">calculate_mf</a></span><span class="op">(</span><span class="va">example_data</span>,</span></span>
<span class="r-in"><span>                    cols_to_group <span class="op">=</span> <span class="st">"sample"</span>,</span></span>
<span class="r-in"><span>                    subtype_resolution <span class="op">=</span> <span class="st">"none"</span>,</span></span>
<span class="r-in"><span>                    retain_metadata_cols <span class="op">=</span> <span class="st">"dose"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mf2</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_mf.html">calculate_mf</a></span><span class="op">(</span><span class="va">example_data</span>,</span></span>
<span class="r-in"><span>                    cols_to_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sample"</span>, <span class="st">"label"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    subtype_resolution <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mf3</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_mf.html">calculate_mf</a></span><span class="op">(</span><span class="va">example_data</span>,</span></span>
<span class="r-in"><span>                    cols_to_group <span class="op">=</span> <span class="st">"dose"</span>,</span></span>
<span class="r-in"><span>                    subtype_resolution <span class="op">=</span> <span class="st">"base_6"</span>,</span></span>
<span class="r-in"><span>                    variant_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-ambiguous"</span>, <span class="st">"-uncategorized"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mf1</span>, <span class="va">mf2</span>, <span class="va">mf3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">list</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mf1"</span>, <span class="st">"mf2"</span>, <span class="st">"mf3"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># save a single data frame to an Excel file</span></span></span>
<span class="r-in"><span><span class="fu">write_excel</span><span class="op">(</span><span class="va">mf1</span>, <span class="va">output_path</span>, workbook_name <span class="op">=</span> <span class="st">"test_single"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#save a list of data frames to an Excel file</span></span></span>
<span class="r-in"><span><span class="fu">write_excel</span><span class="op">(</span><span class="va">list</span>, <span class="va">output_path</span>, workbook_name <span class="op">=</span> <span class="st">"test_list"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># save model results to an Excel file</span></span></span>
<span class="r-in"><span><span class="va">model</span>  <span class="op">&lt;-</span> <span class="fu"><a href="model_mf.html">model_mf</a></span><span class="op">(</span><span class="va">mf1</span>,</span></span>
<span class="r-in"><span>                   fixed_effects <span class="op">=</span> <span class="st">"dose"</span>,</span></span>
<span class="r-in"><span>                   reference_level <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                   contrasts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>col1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12.5</span>, <span class="fl">25</span>, <span class="fl">50</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                          col2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">write_excel</span><span class="op">(</span><span class="va">model</span>,</span></span>
<span class="r-in"><span>            workbook_name <span class="op">=</span> <span class="st">"test_model"</span>,</span></span>
<span class="r-in"><span>            model_results <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Annette E. Dodge, Andrew Williams, Danielle P.M. LeBlanc, David M. Schuster, Elena Esina, Clint C. Valentine, Jesse J. Salk, Alexander Y. Maslov, Christopher Bradley, Carole L. Yauk, Francesco Marchetti, Matthew J. Meier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

