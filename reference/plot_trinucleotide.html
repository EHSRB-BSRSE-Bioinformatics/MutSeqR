<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot the trinucleotide spectrum — plot_trinucleotide • MutSeqR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot the trinucleotide spectrum — plot_trinucleotide"><meta name="description" content="Creates barplots of the trinucleotide spectrum for all levels of
a given group."><meta property="og:description" content="Creates barplots of the trinucleotide spectrum for all levels of
a given group."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MutSeqR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EHSRB-BSRSE-Bioinformatics/MutSeqR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot the trinucleotide spectrum</h1>
      <small class="dont-index">Source: <a href="https://github.com/EHSRB-BSRSE-Bioinformatics/MutSeqR/blob/main/R/plot_trinucleotide.R" class="external-link"><code>R/plot_trinucleotide.R</code></a></small>
      <div class="d-none name"><code>plot_trinucleotide.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates barplots of the trinucleotide spectrum for all levels of
a given group.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_trinucleotide</span><span class="op">(</span></span>
<span>  <span class="va">mf_96</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"proportion"</span>,</span>
<span>  mf_type <span class="op">=</span> <span class="st">"min"</span>,</span>
<span>  group_col <span class="op">=</span> <span class="st">"dose"</span>,</span>
<span>  indiv_y <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sum_totals <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  output_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output_type <span class="op">=</span> <span class="st">"svg"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mf-">mf_96<a class="anchor" aria-label="anchor" href="#arg-mf-"></a></dt>
<dd><p>A data frame containing the mutation frequency data at the
96-base resolution. This should be obtained using the 'calculate_mf' with
subtype_resolution set to 'base_96'. Generally, cols_to_group should be the
same as 'group_col'.</p></dd>


<dt id="arg-response">response<a class="anchor" aria-label="anchor" href="#arg-response"></a></dt>
<dd><p>A character string specifying the type of response to plot.
Must be one of 'frequency', 'proportion', or 'sum'.</p></dd>


<dt id="arg-mf-type">mf_type<a class="anchor" aria-label="anchor" href="#arg-mf-type"></a></dt>
<dd><p>A character string specifying the mutation count method to
plot. Must be one of 'min' or 'max'. Default is 'min'.</p></dd>


<dt id="arg-group-col">group_col<a class="anchor" aria-label="anchor" href="#arg-group-col"></a></dt>
<dd><p>A character string specifying the column(s) in 'mf_96'
to group the data by. Default is 'sample'. The sum, proportion, or frequency
will be plotted for all unique levels of this
group. You can specify more than one column to group by. Generally the same
as the 'cols_to_group' parameter in 'calculate_mf' when generating mf_96.</p></dd>


<dt id="arg-indiv-y">indiv_y<a class="anchor" aria-label="anchor" href="#arg-indiv-y"></a></dt>
<dd><p>A logical value specifying whether the the max response value
for the y-axis should be scaled independently for each group (TRUE) or scaled
the same for all groups (FALSE). Default is FALSE.</p></dd>


<dt id="arg-sum-totals">sum_totals<a class="anchor" aria-label="anchor" href="#arg-sum-totals"></a></dt>
<dd><p>A logical value specifying whether to display the total
sum of mutations in the mutation labels. Default is TRUE.</p></dd>


<dt id="arg-output-path">output_path<a class="anchor" aria-label="anchor" href="#arg-output-path"></a></dt>
<dd><p>An optional file path to an output directory. If provided,
the plots will be automatically exported using the graphics device
specified in output_type. The function will create the output directory if it
doesn't already exist. If NULL, plots will not be exported. Default is NULL.</p></dd>


<dt id="arg-output-type">output_type<a class="anchor" aria-label="anchor" href="#arg-output-type"></a></dt>
<dd><p>A character string specifying the type of output file.
Options are  'eps', 'ps', 'tex', 'pdf', or 'jpeg', 'tiff', 'png', 'bmp',
'svg', or 'wmf' (windows only). Default is 'svg'.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A named list containing ggplots.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function plots the trinucleotide spectrum for all levels of a
given group from the provided mf_96 data; the output of calculate_mf with
subtype_resolution = "base_96".</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load example data</span></span></span>
<span class="r-in"><span><span class="va">example_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> <span class="st">"extdata"</span>, <span class="st">"Example_files"</span>,</span></span>
<span class="r-in"><span> <span class="st">"example_mutation_data_filtered.rds"</span>,</span></span>
<span class="r-in"><span> package <span class="op">=</span> <span class="st">"MutSeqR"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">example_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="va">example_file</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate the mutation frequency data at the 96-base resolution</span></span></span>
<span class="r-in"><span><span class="va">mf_96</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_mf.html">calculate_mf</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> mutation_data <span class="op">=</span> <span class="va">example_data</span>,</span></span>
<span class="r-in"><span> cols_to_group <span class="op">=</span> <span class="st">"dose_group"</span>,</span></span>
<span class="r-in"><span> subtype_resolution <span class="op">=</span> <span class="st">"base_96"</span>,</span></span>
<span class="r-in"><span> variant_types <span class="op">=</span> <span class="st">"snv"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Performing internal depth correction to prevent double-counting...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Internal depth correction complete.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Joining with `by = join_by(dose_group, normalized_context)`</span>
<span class="r-in"><span><span class="co"># Plot the trinucleotide proportions for each dose group</span></span></span>
<span class="r-in"><span><span class="co"># Scale y-axis the same for all groups</span></span></span>
<span class="r-in"><span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu">plot_trinucleotide</span><span class="op">(</span></span></span>
<span class="r-in"><span> mf_96 <span class="op">=</span> <span class="va">mf_96</span>,</span></span>
<span class="r-in"><span> response <span class="op">=</span> <span class="st">"proportion"</span>,</span></span>
<span class="r-in"><span> mf_type <span class="op">=</span> <span class="st">"min"</span>,</span></span>
<span class="r-in"><span> group_col <span class="op">=</span> <span class="st">"dose_group"</span>,</span></span>
<span class="r-in"><span> indiv_y <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span> output_path <span class="op">=</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Annette E. Dodge, Andrew Williams, Danielle P.M. LeBlanc, David M. Schuster, Elena Esina, Clint C. Valentine, Jesse J. Salk, Alexander Y. Maslov, Christopher Bradley, Carole L. Yauk, Francesco Marchetti, Matthew J. Meier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

