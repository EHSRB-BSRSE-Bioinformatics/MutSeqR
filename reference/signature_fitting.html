<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Run COSMIC signatures comparison using SigProfilerAssignment — signature_fitting • MutSeqR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Run COSMIC signatures comparison using SigProfilerAssignment — signature_fitting"><meta name="description" content="Run COSMIC signatures comparison using SigProfilerAssignment"><meta property="og:description" content="Run COSMIC signatures comparison using SigProfilerAssignment"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MutSeqR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EHSRB-BSRSE-Bioinformatics/MutSeqR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Run COSMIC signatures comparison using SigProfilerAssignment</h1>
      <small class="dont-index">Source: <a href="https://github.com/EHSRB-BSRSE-Bioinformatics/MutSeqR/blob/main/R/signature_fitting.R" class="external-link"><code>R/signature_fitting.R</code></a></small>
      <div class="d-none name"><code>signature_fitting.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Run COSMIC signatures comparison using SigProfilerAssignment</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">signature_fitting</span><span class="op">(</span></span>
<span>  <span class="va">mutation_data</span>,</span>
<span>  project_name <span class="op">=</span> <span class="st">"Default"</span>,</span>
<span>  project_genome <span class="op">=</span> <span class="st">"GRCh38"</span>,</span>
<span>  env_name <span class="op">=</span> <span class="st">"MutSeqR"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"sample"</span>,</span>
<span>  output_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">python_version</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mutation-data">mutation_data<a class="anchor" aria-label="anchor" href="#arg-mutation-data"></a></dt>
<dd><p>A data frame containing mutation data.</p></dd>


<dt id="arg-project-name">project_name<a class="anchor" aria-label="anchor" href="#arg-project-name"></a></dt>
<dd><p>The name of the project. This is used to format
the data into required .txt format for SigProfiler tools.</p></dd>


<dt id="arg-project-genome">project_genome<a class="anchor" aria-label="anchor" href="#arg-project-genome"></a></dt>
<dd><p>The reference genome to use. On first use, the
function will install the genome using SigProfilerMatrixGeneratorR::install.
e.x. GRCh37, GRCH38, mm10, mm9, rn6</p></dd>


<dt id="arg-env-name">env_name<a class="anchor" aria-label="anchor" href="#arg-env-name"></a></dt>
<dd><p>The name of the virtual environment. This will be created on
first use.</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>The column in the mutation data used to aggregate groups.
Signature assignment will be performed on each group separately.</p></dd>


<dt id="arg-output-path">output_path<a class="anchor" aria-label="anchor" href="#arg-output-path"></a></dt>
<dd><p>The filepath to the directory in which the output folder
will be created to store results. Default is NULL. This will store results
in the current working directory.</p></dd>


<dt id="arg-python-version">python_version<a class="anchor" aria-label="anchor" href="#arg-python-version"></a></dt>
<dd><p>The version of python installed on the user's
computer.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Creates a subfolder "SigProfiler" in the output directory with
SigProfiler tools results. For a complete breakdown of the results, see the
Readme file for MutSeqR. Most relevant results are stored in SigProfiler &gt;
<a href="https://rdrr.io/r/grDevices/plotmath.html" class="external-link">group</a> &gt; matrices &gt; output &gt; Assignment_Solution &gt; Activities &gt;
SampleReconstruction &gt; WebPNGs.
These plots show a summary of the signature assignment results for each
group. In each plot, the top left panel represents the base_96 mutation
count for the group. The bottom left panel represents the reconstructed
profile. Below the reconstruction are the solution statistics that indicate
the goodness of fit of the reconstructed profile to the observed profile.
(Recommended cosine similarity &gt; 0.9). The panels on the right represent the
SBS signatures that contribute to the reconstructed profile. The signature
name and its contribution % are shown in the panel. A high contribution
means a high association of the signature with the group's mutation
spectra.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Assign COSMIC SBS signatures to mutation data using
SigProfilerAssignment. Data is cleaned and formatted for input into
SigProfiler tools. This function will create a virtual environment using
reticulate to run python, as this is a requirement for the SigProfiler suite
of tools. Note that it will also install several python dependencies using
a conda virtual environment on first use. Please be aware of the
implications of this. For advanced use, it is suggested to use the
SigProfiler python tools directly in python as described in their
respective documentation. Users must have python installed on their
computer to use this function.</p>
<p>Mutation data will be filtered to only include SNVs. Variants
flagged by the filter_mut column will be excluded.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">example_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Example_files"</span>,</span></span>
<span class="r-in"><span>                            <span class="st">"example_mutation_data_filtered.rds"</span>,</span></span>
<span class="r-in"><span>                            package <span class="op">=</span> <span class="st">"MutSeqR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">example_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="va">example_file</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">signature_fitting</span><span class="op">(</span>mutation_data <span class="op">=</span> <span class="va">example_data</span>,</span></span>
<span class="r-in"><span>                  project_name <span class="op">=</span> <span class="st">"Example"</span>,</span></span>
<span class="r-in"><span>                  project_genome <span class="op">=</span> <span class="st">"mm10"</span>,</span></span>
<span class="r-in"><span>                  env_name <span class="op">=</span> <span class="st">"MutSeqR"</span>,</span></span>
<span class="r-in"><span>                  group <span class="op">=</span> <span class="st">"dose"</span>,</span></span>
<span class="r-in"><span>                  python_version <span class="op">=</span> <span class="st">"3.11"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Annette E. Dodge, Andrew Williams, Danielle P.M. LeBlanc, David M. Schuster, Elena Esina, Clint C. Valentine, Jesse J. Salk, Alexander Y. Maslov, Christopher Bradley, Carole L. Yauk, Francesco Marchetti, Matthew J. Meier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

