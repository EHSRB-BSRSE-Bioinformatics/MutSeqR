<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Transition-transversion plot — plot_spectra • MutSeqR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Transition-transversion plot — plot_spectra"><meta name="description" content="Given mf data, construct a plot displaying the
mutation subtypes observed in a cohort."><meta property="og:description" content="Given mf data, construct a plot displaying the
mutation subtypes observed in a cohort."><meta property="og:image" content="https://ehsrb-bsrse-bioinformatics.github.io/MutSeqR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MutSeqR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/MutSeqR_introduction.html">Overview of MutSeqR workflow</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EHSRB-BSRSE-Bioinformatics/MutSeqR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Transition-transversion plot</h1>
      <small class="dont-index">Source: <a href="https://github.com/EHSRB-BSRSE-Bioinformatics/MutSeqR/blob/Try-quarto-vignette/R/plot_spectra.R" class="external-link"><code>R/plot_spectra.R</code></a></small>
      <div class="d-none name"><code>plot_spectra.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given mf data, construct a plot displaying the
mutation subtypes observed in a cohort.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_spectra</span><span class="op">(</span></span>
<span>  <span class="va">mf_data</span>,</span>
<span>  group_col <span class="op">=</span> <span class="st">"sample"</span>,</span>
<span>  subtype_resolution <span class="op">=</span> <span class="st">"base_6"</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"proportion"</span>,</span>
<span>  mf_type <span class="op">=</span> <span class="st">"min"</span>,</span>
<span>  group_order <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  group_order_input <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dist <span class="op">=</span> <span class="st">"cosine"</span>,</span>
<span>  cluster_method <span class="op">=</span> <span class="st">"ward.D"</span>,</span>
<span>  custom_palette <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x_lab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y_lab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rotate_xlabs <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mf-data">mf_data<a class="anchor" aria-label="anchor" href="#arg-mf-data"></a></dt>
<dd><p>A data frame containing the mutation frequency data at the
desired subtype resolution. This is obtained using the 'calculate_mf'
function with subtype_resolution set to the desired resolution.
Data must include a column containing the group_col,
a column containing the mutation subtypes, a column containing the desired
response variable (mf, proportion, sum) for the desired mf_type
(min or max), and if applicable, a column containing the variable by which
to order the samples/groups.</p></dd>


<dt id="arg-group-col">group_col<a class="anchor" aria-label="anchor" href="#arg-group-col"></a></dt>
<dd><p>The name of the column(s) in the mf data that contains the
sample/group names. This will generally be the same values used for the
cols_to_group argument in the calculate_mf function. However, you may
also use groups that are at a higher level of the aggregation in mf_data.</p></dd>


<dt id="arg-subtype-resolution">subtype_resolution<a class="anchor" aria-label="anchor" href="#arg-subtype-resolution"></a></dt>
<dd><p>The subtype resolution of the mf data.
Options are <code>base_6</code>, <code>base_12</code>, <code>base_96</code>, <code>base_192</code>, or <code>type</code>.
Default is <code>base_6</code>.</p></dd>


<dt id="arg-response">response<a class="anchor" aria-label="anchor" href="#arg-response"></a></dt>
<dd><p>The desired response variable to be plotted. Options are
mf, proportion, or sum. Default is <code>proportion</code>. Your mf_data must contain
columns with the name of your desired response: <code>mf_min</code>, <code>mf_max</code>,
<code>proportion_min</code>, <code>proportion_max</code>, <code>sum_min</code>, and <code>sum_max</code>.</p></dd>


<dt id="arg-mf-type">mf_type<a class="anchor" aria-label="anchor" href="#arg-mf-type"></a></dt>
<dd><p>The mutation counting method to use. Options are min or max.
Default is <code>min</code>.</p></dd>


<dt id="arg-group-order">group_order<a class="anchor" aria-label="anchor" href="#arg-group-order"></a></dt>
<dd><p>The method for ordering the samples within the plot.
Options include:</p><ul><li><p><code>none</code>: No ordering is performed. Default.</p></li>
<li><p><code>smart</code>: Groups are automatically ordered based on the group names
(alphabetical, numerical)</p></li>
<li><p><code>arranged</code>: Groups are ordered based on one or more factor column(s)
in mf_data. Column names are passed to the function using the
<code>group_order_input</code>.</p></li>
<li><p><code>custom</code>: Groups are ordered based on a custom vector of group
names. The custom vector is passed to the function using the
<code>group_order_input</code>.</p></li>
<li><p><code>clustered</code>: Groups are ordered based on hierarchical clustering. The
dissimilarity matrix can be specified using the <code>dist</code> argument. The
agglomeration method can be specified using the <code>cluster_method</code> argument.</p></li>
</ul></dd>


<dt id="arg-group-order-input">group_order_input<a class="anchor" aria-label="anchor" href="#arg-group-order-input"></a></dt>
<dd><p>A character vector specifying details for the
group order method. If <code>group_order</code> is <code>arranged</code>, <code>group_order_input</code>
should contain the column name(s) to be used for ordering the samples. If
<code>group_order</code> is <code>custom</code>, <code>group_order_input</code> should contain the custom
vector of group names.</p></dd>


<dt id="arg-dist">dist<a class="anchor" aria-label="anchor" href="#arg-dist"></a></dt>
<dd><p>The dissimilarity matrix for hierarchical clustering. Options
are <code>cosine</code>, <code>euclidean</code>, <code>maximum</code>, <code>manhattan</code>, <code>canberra</code>, <code>binary</code> or
<code>minkowski</code>. The default is <code>cosine</code>. See <a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a> for details.</p></dd>


<dt id="arg-cluster-method">cluster_method<a class="anchor" aria-label="anchor" href="#arg-cluster-method"></a></dt>
<dd><p>The agglomeration method for hierarchical clustering.
Options are <code>ward.D</code>, <code>ward.D2</code>, <code>single</code>, <code>complete</code>, <code>average</code> (= UPGMA),
<code>mcquitty</code> (= WPGMA), <code>median</code> (= WPGMC) or <code>centroid</code> (= UPGMC). The default
is <code>Ward.D</code>. See <a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a> for details.</p></dd>


<dt id="arg-custom-palette">custom_palette<a class="anchor" aria-label="anchor" href="#arg-custom-palette"></a></dt>
<dd><p>A named vector of colors to be used for the mutation
subtypes. The names of the vector should correspond to the mutation subtypes
in the data. Alternatively, you can specify a color palette from the
RColorBrewer package. See <code><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></code> for palette
options. You may visualize the palettes at the ColorBrewer website:
<a href="https://colorbrewer2.org/" class="external-link">https://colorbrewer2.org/</a>. Default is <code>NULL</code>.</p></dd>


<dt id="arg-x-lab">x_lab<a class="anchor" aria-label="anchor" href="#arg-x-lab"></a></dt>
<dd><p>The label for the x-axis. Default is the value of <code>group_col</code>.</p></dd>


<dt id="arg-y-lab">y_lab<a class="anchor" aria-label="anchor" href="#arg-y-lab"></a></dt>
<dd><p>The label for the y-axis. Default is the value of <code>response_col</code>.</p></dd>


<dt id="arg-rotate-xlabs">rotate_xlabs<a class="anchor" aria-label="anchor" href="#arg-rotate-xlabs"></a></dt>
<dd><p>A logical value indicating whether the x-axis labels
should be rotated 90 degrees. Default is FALSE.</p></dd>

</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load example data</span></span></span>
<span class="r-in"><span><span class="va">example_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Example_files"</span>,</span></span>
<span class="r-in"><span>                            <span class="st">"example_mutation_data_filtered.rds"</span>,</span></span>
<span class="r-in"><span>                            package <span class="op">=</span> <span class="st">"MutSeqR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">example_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="va">example_file</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 1: plot the proportion of 6-based mutation subtypes</span></span></span>
<span class="r-in"><span><span class="co"># for each sample, organized by dose group:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate the mutation frequency data at the 6-base resolution.</span></span></span>
<span class="r-in"><span><span class="co"># Retain the dose_group column to use for ordering the samples.</span></span></span>
<span class="r-in"><span><span class="va">mf_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_mf.html">calculate_mf</a></span><span class="op">(</span>mutation_data <span class="op">=</span> <span class="va">example_data</span>,</span></span>
<span class="r-in"><span>                        cols_to_group <span class="op">=</span> <span class="st">"sample"</span>,</span></span>
<span class="r-in"><span>                        subtype_resolution <span class="op">=</span> <span class="st">"base_6"</span>,</span></span>
<span class="r-in"><span>                        retain_metadata_cols <span class="op">=</span> <span class="st">"dose_group"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Performing internal depth correction to prevent double-counting...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Internal depth correction complete.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Joining with `by = join_by(normalized_subtype, sample)`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Joining with `by = join_by(sample, normalized_ref)`</span>
<span class="r-in"><span><span class="co"># Set the desired order for the dose_group levels.</span></span></span>
<span class="r-in"><span><span class="va">mf_data</span><span class="op">$</span><span class="va">dose_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">mf_data</span><span class="op">$</span><span class="va">dose_group</span>,</span></span>
<span class="r-in"><span>                             levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Low"</span>, <span class="st">"Medium"</span>, <span class="st">"High"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Plot the mutation spectra</span></span></span>
<span class="r-in"><span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu">plot_spectra</span><span class="op">(</span>mf_data <span class="op">=</span> <span class="va">mf_data</span>,</span></span>
<span class="r-in"><span>                     group_col <span class="op">=</span> <span class="st">"sample"</span>,</span></span>
<span class="r-in"><span>                     subtype_resolution <span class="op">=</span> <span class="st">"base_6"</span>,</span></span>
<span class="r-in"><span>                     response <span class="op">=</span> <span class="st">"proportion"</span>,</span></span>
<span class="r-in"><span>                     group_order <span class="op">=</span> <span class="st">"arranged"</span>,</span></span>
<span class="r-in"><span>                     group_order_input <span class="op">=</span> <span class="st">"dose_group"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: plot the proportion of 6-based mutation subtypes</span></span></span>
<span class="r-in"><span><span class="co"># for each sample, ordered by hierarchical clustering:</span></span></span>
<span class="r-in"><span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu">plot_spectra</span><span class="op">(</span>mf_data <span class="op">=</span> <span class="va">mf_data</span>,</span></span>
<span class="r-in"><span>                     group_col <span class="op">=</span> <span class="st">"sample"</span>,</span></span>
<span class="r-in"><span>                     subtype_resolution <span class="op">=</span> <span class="st">"base_6"</span>,</span></span>
<span class="r-in"><span>                     response <span class="op">=</span> <span class="st">"proportion"</span>,</span></span>
<span class="r-in"><span>                     group_order <span class="op">=</span> <span class="st">"clustered"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>`scale_x_dendrogram()` was deprecated in ggh4x 0.3.0.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Please use `legendry::scale_x_dendro()` instead.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">MutSeqR</span> package.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   Please report the issue at</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   <span style="color: #0000BB; font-style: italic;">&lt;https://github.com/EHSRB-BSRSE-Bioinformatics/MutSeqR/issues&gt;</span>.</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Annette E. Dodge, Andrew Williams, Danielle P.M. LeBlanc, David M. Schuster, Elena Esina, Clint C. Valentine, Jesse J. Salk, Alexander Y. Maslov, Christopher Bradley, Carole L. Yauk, Francesco Marchetti, Matthew J. Meier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

