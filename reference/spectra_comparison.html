<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compare the overall mutation spectra between groups — spectra_comparison • MutSeqR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compare the overall mutation spectra between groups — spectra_comparison"><meta name="description" content="spectra_comparison compares the mutation spectra of groups using a
modified contingency table approach."><meta property="og:description" content="spectra_comparison compares the mutation spectra of groups using a
modified contingency table approach."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MutSeqR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EHSRB-BSRSE-Bioinformatics/MutSeqR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Compare the overall mutation spectra between groups</h1>
      <small class="dont-index">Source: <a href="https://github.com/EHSRB-BSRSE-Bioinformatics/MutSeqR/blob/main/R/spectra_comparison.R" class="external-link"><code>R/spectra_comparison.R</code></a></small>
      <div class="d-none name"><code>spectra_comparison.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>spectra_comparison compares the mutation spectra of groups using a
modified contingency table approach.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spectra_comparison</span><span class="op">(</span></span>
<span>  <span class="va">mf_data</span>,</span>
<span>  <span class="va">exp_variable</span>,</span>
<span>  mf_type <span class="op">=</span> <span class="st">"min"</span>,</span>
<span>  <span class="va">contrasts</span>,</span>
<span>  cont_sep <span class="op">=</span> <span class="st">"\t"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mf-data">mf_data<a class="anchor" aria-label="anchor" href="#arg-mf-data"></a></dt>
<dd><p>A data frame containing the MF data. This
is the output from calculate_mf(). MF data should be at the
desired subtype resolution. Required columns are the exp_variable column(s),
the subtype column, and sum_min or sum_max.</p></dd>


<dt id="arg-exp-variable">exp_variable<a class="anchor" aria-label="anchor" href="#arg-exp-variable"></a></dt>
<dd><p>The column names of the experimental variable(s) to be
compared.</p></dd>


<dt id="arg-mf-type">mf_type<a class="anchor" aria-label="anchor" href="#arg-mf-type"></a></dt>
<dd><p>The type of mutation frequency to use. Default is "min"
(recommended).</p></dd>


<dt id="arg-contrasts">contrasts<a class="anchor" aria-label="anchor" href="#arg-contrasts"></a></dt>
<dd><p>a filepath to a file OR a dataframe that specifies the
comparisons to be made between levels of the exp_variable(s) The table must
consist of two columns, each containing a level of the exp_variable. The
level in the first column will compared to the level in the second column
for each row in contrasts. When using more than one exp_variable, separate
the levels of each variable with a colon. Ensure that all variables listed
in exp_variable are represented in each entry for the table. See details for
examples.</p></dd>


<dt id="arg-cont-sep">cont_sep<a class="anchor" aria-label="anchor" href="#arg-cont-sep"></a></dt>
<dd><p>The delimiter used to import the contrasts table.
Default is tab.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>the log-likelihood statistic G2 for the specified comparisons with
the p-value adjusted for multiple-comparisons.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function creates an R * 2 contigency table of the subtype counts, where
R is the number of subtypes for the 2 groups being compared. The G2 likelihood
ratio statistic is used to evaluate whether the proportion
(count/group total) of each mutation subtype equals that of the other group.</p>
<p>The G2 statistic refers to a chi-squared distribution to compute the p-value
for large sample sizes. When N / (R-1) &lt; 20, where N is the total mutation
counts across both groups, the function will use a F-distribution to compute
the p-value in order to reduce false positive rates.</p>
<p>The comparison assumes independance among the observations, as such, it is
highly recommended to use mf_type = "min".</p>
<p>Examples of <code>contrasts</code>:
For 'exp_variable = "dose"` with dose groups 0, 12.5, 25, 50, compare each
treated dose to the control:</p>
<p>12.5 0</p>
<p>25 0</p>
<p>50 0</p>
<p>Ex. Consider two 'exp_variables = c("dose", "tissue")`;
with levels dose (0, 12.5, 25, 50) and tissue("bone_marrow", "liver").
To compare the mutation spectra between tissues for each dose group,
the contrast table would look like:</p>
<p>0:bone_marrow	0:liver</p>
<p>12.5:bone_marrow	12.5:liver</p>
<p>25:bone_marrow	25:liver</p>
<p>50:bone_marrow	50:liver</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load the example data</span></span></span>
<span class="r-in"><span><span class="va">example_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Example_files"</span>,</span></span>
<span class="r-in"><span>                            <span class="st">"example_mutation_data_filtered.rds"</span>,</span></span>
<span class="r-in"><span>                            package <span class="op">=</span> <span class="st">"MutSeqR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">example_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="va">example_file</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example: compare 6-base mutation spectra between dose groups</span></span></span>
<span class="r-in"><span><span class="co"># Calculate the mutation frequency data at the 6-base resolution</span></span></span>
<span class="r-in"><span><span class="va">mf_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_mf.html">calculate_mf</a></span><span class="op">(</span>mutation_data <span class="op">=</span> <span class="va">example_data</span>,</span></span>
<span class="r-in"><span>                        cols_to_group <span class="op">=</span> <span class="st">"dose_group"</span>,</span></span>
<span class="r-in"><span>                         subtype_resolution <span class="op">=</span> <span class="st">"base_6"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Performing internal depth correction to prevent double-counting...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Internal depth correction complete.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Joining with `by = join_by(dose_group, normalized_ref)`</span>
<span class="r-in"><span><span class="co"># Create the contrasts table</span></span></span>
<span class="r-in"><span><span class="va">contrasts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>col1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Low"</span>, <span class="st">"Medium"</span>, <span class="st">"High"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        col2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Run the comparison</span></span></span>
<span class="r-in"><span><span class="fu">spectra_comparison</span><span class="op">(</span>mf_data <span class="op">=</span> <span class="va">mf_data</span>,</span></span>
<span class="r-in"><span>                   exp_variable <span class="op">=</span> <span class="st">"dose_group"</span>,</span></span>
<span class="r-in"><span>                   mf_type <span class="op">=</span> <span class="st">"min"</span>,</span></span>
<span class="r-in"><span>                   contrasts <span class="op">=</span> <span class="va">contrasts</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using chi-squared distribution to compute p-value</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using chi-squared distribution to compute p-value</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using chi-squared distribution to compute p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           contrasts       G2 p.value adj_p.value Significance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    Low vs Control 195.6281       0           0          ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Medium vs Control 503.3807       0           0          ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   High vs Control 714.0200       0           0          ***</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Annette E. Dodge, Andrew Williams, Danielle P.M. LeBlanc, David M. Schuster, Elena Esina, Clint C. Valentine, Jesse J. Salk, Alexander Y. Maslov, Christopher Bradley, Carole L. Yauk, Francesco Marchetti, Matthew J. Meier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

