% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/import_mut_data.R
\name{import_mut_data}
\alias{import_mut_data}
\title{Import a .mut file}
\usage{
import_mut_data(
  mut_file,
  mut_sep = "\\t",
  is_0_based_mut = TRUE,
  sample_data = NULL,
  sd_sep = "\\t",
  regions = c("TSpanel_human", "TSpanel_mouse", "TSpanel_rat", "custom", "none"),
  custom_regions = NULL,
  rg_sep = "\\t",
  is_0_based_rg = TRUE,
  range_buffer = 0,
  genome = NULL,
  species = NULL,
  masked_BS_genome = FALSE,
  custom_column_names = NULL,
  output_granges = FALSE
)
}
\arguments{
\item{mut_file}{"filepath". The .mut file containing mutation
data to be imported. This can be either a data frame object or a filepath
to a file or directory. If you specify a folder, the function will
attempt to read all files in the folder and combine them into
a single data frame. Required columns are listed below.
Synonymous names for these columns are accepted.
\itemize{
\item \code{contig}: The reference sequence name.
\item \code{start}: 0-based start position of the feature in contig.
\item \code{end}: half-open end position of the feature in contig.
\item \code{sample}: The sample name.
\item \code{ref}: The reference allele at this position
\item \code{alt}: The left-aligned, normalized, alternate allele at this
position.
}
The following columns are not required, but are recommended for full
package functionality:
\itemize{
\item \code{alt_depth}: The read depth supporting the alternate allele. If
not included, the function will assume a value of 1.
\item depth col: The total read depth at this position. This column can
be \code{total_depth} (excluding N-calls) or \code{depth}(including N-calls; if
\code{total_depth} is not available.
}}

\item{mut_sep}{The delimiter for importing the .mut file.
Default is tab-delimited.}

\item{is_0_based_mut}{A logical variable. Indicates whether the
position coordinates in the mutation data are 0 based (TRUE) or
1 based (FALSE). If TRUE, positions will be converted to 1-based.}

\item{sample_data}{An optional file containing additional sample
metadata (dose, timepoint, etc.). This can be a data frame or a file path.}

\item{sd_sep}{The delimiter for importing sample metadata table.
Default is tab-delimited.}

\item{regions}{Values are \verb{c("TSpanel_human", "TSpanel_mouse", "TSpanel_rat" "custom", "none")}.
Indicates the target panel used for Duplex Sequencing.
The argument refers to the TS Mutagenesis panel of the
specified species, or to a custom panel. If "custom",
provide the file path of your regions file in
\code{custom_regions}.}

\item{custom_regions}{If \code{regions} is set to
"custom", provide  the regions metadata. Can be a file path or a
data frame.Required columns are \code{contig}, \code{start}, and \code{end}.}

\item{rg_sep}{The delimiter for importing the \code{custom_regions}.
Default is tab-delimited.}

\item{is_0_based_rg}{A logical variable. Indicates whether the
position coordinates in the custom_regions are 0 based (TRUE) or
1 based (FALSE). If TRUE, positions will be converted to 1-based.}

\item{range_buffer}{An integer >= 0. Extend the range of your regions
in both directions by the given amount. Ex. Structural variants and
indels may start outside of the regions. Adjust the range_buffer to
include these variants in your regions.}

\item{genome}{The genome assembly of the reference genome. This is only
required if your data does not include a context column. The
function will install a BS genome for the given species/genome/masked to
populate the context column.
Ex.Human GRCh38 = hg38 | Human GRCh37 = hg19 | Mouse GRCm38 = mm10 |
Mouse GRCm39 = mm39 | Rat RGSC 6.0 = rn6 | Rat mRatBN7.2 = rn7}

\item{species}{The species of your data. Required if
your data does not include a context column. The
function will install a BS genome for the given species/genome/masked to
populate the context column. The species can be the common name of the
species or the scientific name. Ex. "human" or "Homo sapiens".}

\item{masked_BS_genome}{A logical value. Required when using a BS genome
to poulate the context column. Whether to use the masked version of the
BS genome (TRUE) or not (FALSE). Default is FALSE.}

\item{custom_column_names}{A list of names to specify the meaning of column
headers. Since column names can vary with data, this might be necessary to
digest the mutation data table properly. Typical defaults are set, but can
be substituted in the form of \code{list(total_depth = "my_custom_depth_name", sample = "my_custom_sample_column_name")}. For a comprehensive list, see
examples. You can change one or more of these.}

\item{output_granges}{A logical variable; whether you want the mutation
data to output as a GRanges object. Default output (FALSE) is as a dataframe.}
}
\value{
A table where each row is a mutation, and columns indicate the
location, type, and other data. If \code{output_granges} is set to TRUE, the
mutation data will be returned as a GRanges object, otherwise mutation
data is returned as a dataframe.

Output Column Definitions:
\itemize{
\item \code{nchar_ref}: The length (in bp) of the reference allele.
\item \code{nchar_alt}: The length (in bp) of the alternate allele.
\item \code{varlen}: The length (in bp) of the variant.
\item \code{total_depth}: The total read depth at this position, excluding
N-calls.
\code{alt_depth}/\code{depth_col} where \code{depth_col} can be \code{total_depth} or \code{depth}.
reference allele. Calculated as \code{depth_col} - \code{alt_depth} where
\code{depth_col} can be \code{total_depth}or \code{depth}.
\item \code{subtype}: The substitution type for the snv variant
(12-base spectrum; e.g. A>C)
\item \code{short_ref}: The reference base at this position.
\item \code{normalized_subtype}: The C/T-based substitution type for the
snv variant (6-base spectrum; e.g. A>C -> T>G).
\item \code{normalized_ref}: The reference base in C/T-base notation for
this position (e.g. A -> T).
\item \code{context_with_mutation}: The substitution type fo the snv variant
including the two flanking nucleotides (192-trinucleotide spectrum;
e.g. \verb{T[A>C]G})
\item \code{normalized_context_with_mutation}: The C/T-based substitution
type for the snv variant including the two flanking nucleotide
(96-base spectrum e.g. \verb{T[A>C]G} -> \verb{C[T>G]A})
\item \code{normalized_context}: The trinucleotide context in C/T base
notation for this position (e.g. TAG -> CTA).
\item \code{gc_content}: \% GC of the trinucleotide context at this position.
\item \code{is_known}: TRUE or FALSE. Flags known variants (ID != ".").
\item \code{row_has_duplicate}: TRUE or FALSE. Flags rows whose position is
the same as that of at least one other row for the same sample.
}
}
\description{
Imports a .mut file into the local R environment.
}
