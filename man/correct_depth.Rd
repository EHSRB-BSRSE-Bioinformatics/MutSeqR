% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculate_mf.R
\name{correct_depth}
\alias{correct_depth}
\title{Correct total depth for unique genomic positions}
\usage{
correct_depth(mutation_data, by_indel_priority = FALSE)
}
\arguments{
\item{mutation_data}{Your mutation data. Must be a data.frame.}

\item{by_indel_priority}{A logical value. If TRUE, the \code{total_depth} value for
the row with the highest priority \code{variation_type} is retained. Priority is:
deletion, complex, insertion, snv, mnv, sv, uncategorised, no_variant.
If FALSE (default), the \code{total_depth} of the first row in the group is retained.}
}
\value{
A data.frame with the \code{total_depth} column corrected.
}
\description{
This function prevents double-counting of sequencing depth when multiple
mutations are reported at the same genomic position within the same sample.
For each group of rows with the same \code{sample}, \code{contig}, and \code{start},
it retains the \code{total_depth} value for only one row and sets the rest to 0.
This is a necessary pre-processing step before calculating mutation frequency
to ensure the denominator (total bases sequenced) is not inflated.
}
\details{
Running this operation can be computationally intensive on large datasets.
By isolating it in a dedicated function, you can run it once and use the
resulting data frame for multiple downstream analyses, such as calls to
\code{calculate_mf} with different grouping variables.
}
\examples{
# Load example data
example_file <- system.file("extdata", "Example_files",
                            "example_mutation_data.rds",
                            package = "MutSeqR")
example_data <- readRDS(example_file)

# Correct the depth
corrected_data <- correct_depth(mutation_data = example_data, by_indel_priority = TRUE)
# Now `corrected_data` can be used for filtering and frequency calculation

}
