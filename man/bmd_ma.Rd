% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bmd.R
\name{bmd_ma}
\alias{bmd_ma}
\title{Fit a model averaged continuous BMD model}
\usage{
bmd_ma(
  mf_data,
  data_type = "individual",
  dose_col = "dose",
  response_cols = c("sample_MF_min", "sample_MF_max"),
  sd_col = NULL,
  n_col = NULL,
  bmr_type = "rel",
  bmr = 0.5,
  fit = "laplace",
  a = 0.025,
  ...
)
}
\arguments{
\item{mf_data}{A data frame containing the dose-response data. Data may
be individual for each sample or averaged over dose groups.
Required columns for individual data are "dose" and "response".
Multiple response columns are allowed. Required columns for summarised
data are "dose", "mean response", "sample size", and "standard deviation".
Only one response column is allowed for summarised data.}

\item{data_type}{A string specifying the type of response data.
Data may be response per individual or summarised across dose groups.
("individual", "summary").}

\item{dose_col}{A character string specifying the column in mf_data
containing the dose data.}

\item{response_cols}{A character vector specifying the columns in mf_data
containing the response data. For summarised data types, this should be
the mean response for each dose group.}

\item{sd_col}{A character string specifying the column in mf_data containing
the standard deviation of the response data. This is only required for
summarised data types.}

\item{n_col}{A character string specifying the column in mf_data containing
the sample size of each dose group. This is only required for summarised
data types.}

\item{bmr_type}{A string specifying the type of benchmark response.
For continuous models, there are four types of BMD definitions that
are commonly used:
\itemize{
\item Relative deviation (default; 'BMR_TYPE = "rel"'). This defines the
BMD as the dose that changes the control mean/median a certain
percentage from the background dose, i.e. it is the dose, BMD that
solves \eqn{\mid f(dose) - f(0) \mid = (1 \pm BMR) f(0)}
\item Standard deviation ('BMR_TYPE = "sd"'). This defines the BMD as
the dose associated with the mean/median changing a specified number of
standard deviations from the mean at the control dose., i.e., it is the
dose, BMD, that solves \eqn{\mid f(dose)-f(0) \mid = BMR \times \sigma}
\item Hybrid deviation ('BMR_TYPE = "hybrid"'). This defines the
BMD that changes the probability of an adverse event by a stated amount
relative to no exposure (i.e 0).  That is, it is the dose, BMD, that solves
\eqn{\frac{Pr(X > x| dose) - Pr(X >x|0)}{Pr(X < x|0)} = BMR}.
For this definition,
\eqn{Pr(X < x|0) = 1 - Pr(X > X|0) = \pi_0}, where \eqn{0 \leq \pi_0 < 1}
is defined by the user as "point_p," and it defaults to 0.01.  Note: this
discussion assumed increasing data.  The fitter determines the direction
of the data and inverts the probability statements for decreasing data.
\item Absolute deviation ('BMR_TYPE="abs"'). This defines the BMD
as an absolute change from the control dose of zero by a specified amount.
That is the BMD is the dose that solves the equation
\eqn{\mid f(dose) - f(0) \mid = BMR}.
}}

\item{bmr}{A numeric value specifying the benchmark response. The BMR is
defined in relation to the calculation requested in bmr_type. Default is 0.5.}

\item{fit}{A string specifying the method used to fit the model.
Options are ("laplace", "mle", or "mcmc"). Default is "laplace".}

\item{a}{The specified nominal coverage rate for computation of
the lower bound on the BMDL and BMDU, i.e., one computes a
\eqn{100\times(1-\alpha)\%} confidence interval.  For the
interval (BMDL,BMDU) this is a \eqn{100\times(1-2\alpha)\% }.
By default, it is set to 0.025 for a CI of 95\%.}

\item{...}{Additional arguments to be passed to the model fitting function.
See \link[ToxicR]{ma_continuous_fit} for details.}
}
\value{
A list with the following components:
\itemize{
\item BMD: A data frame containing the BMD values and
the \eqn{100\times(1-2\alpha)\% } confidence intervals
for each response column.
\item summary: A list containing the summary statistics for each
repsonse column.
\item model_plots: A list containing the model plots for each
response column.
\item cleveland_plots: A list containing the Cleveland
plots for each response column.
\item models: A list containing the model fit values for
each response column. Values include:
\itemize{
\item Individual_Model_X: Individual model fits for each model,
X, used for model averaging. See \link[ToxicR]{single_continuous_fit}
for details on the model object class structure.
\item ma_bmd: The CDF of the model averaged BMD distribution.
\item posterior_probs: the posterior probabilities used in the
model averaging.
}
}
}
\description{
This function fits a model averaged continuous BMD model
to dose-response data for mutation frequency.
}
\details{
Model averaging is done over the default models described
in The European Food Safety Authority's (2022) Guidance on the use
of the benchmark dose approach in risk assessment. These models are:
\itemize{
\item \code{"exp-aerts"}: \eqn{f(x) = a(1 + (c-1)(1-\exp(-bx^{d}))) }
\item \code{"invexp-aerts"}: \eqn{f(x) = a(1 + (c-1)(\exp(-bx^{-d})))}
\item \code{"hill-aerts"}:
\eqn{f(x) = a(1 + (c-1)(1-\frac{b^d}{b^d + x^d}))}
\item \code{"lognormal-aerts"}:
\eqn{f(x) = a\left\{1 + (c-1)\left(\Phi( \ln(b) + d\times \ln(x))\right) \right\}}
\item \code{"gamma-efsa"}: \eqn{f(x) = a(1 + (c-1)(\Gamma(bx; d))) }
\item \code{"LMS"}: \eqn{f(x) = a(1 + (c-1)(1 - \exp(-bx - dx^2))) }
\item \code{"probit-aerts"}:
\eqn{f(x) = c\left(\Phi(a + b\times x^d)\right) }
\item \code{"logistic-aerts"}:
\eqn{f(x) = \frac{c}{1 + \exp(-a - b\times x^d)} }
}
Here: \eqn{\Phi(\cdot)} is the standard normal distribution and
\eqn{\Phi_{SN}(\cdot;\cdot)} is the skew-normal distribution
}
