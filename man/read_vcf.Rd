% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/read_vcf.R
\name{read_vcf}
\alias{read_vcf}
\title{Import a vcf file}
\usage{
read_vcf(
  vcf_file,
  vaf_cutoff,
  sample_data_file = NULL,
  sd_sep = "\\t",
  regions = c("human", "mouse", "custom"),
  custom_regions_file = NULL,
  rg_sep = "\\t",
  genome = NULL,
  depth_calc = "take_del",
  output_granges = FALSE
)
}
\arguments{
\item{vcf_file}{The path to the .vcf file  to be imported. If you
specify a folder, the function will attempt to read all files in the folder and
combine them into on dataset. Multisample vcf files are not supported;
vcf files must contain one sample each.
Required fields are listed below
\itemize{
\item FIXED FIELDS:
\item \code{CHROM}: The reference sequence name.Equivalent to \code{contig}
\item \code{POS}: 0-based start position of the feature in contig.
\item \code{REF}: The reference allele at this position
\item \code{ALT}: The left-aligned, normalized, alternate allele at this position.
\item FORMAT FIELDS:
\item \code{AD}: The allelic depths for the reference and alternate alleles in the order listed.
\item \code{DP}: The total read depth at this position (including N-calls). Equivalent to \code{depth}.
\item \code{VD}: Variant Depth. Equivalent to \code{alt_depth}.
\item INFO FIELDS
\item \code{TYPE}: The category to which this variant is assigned. Equivalent to \code{variation_type}.
\item \code{END}: The half-open end position of the feature in contig.
\item SUGGESTED INFO FIELDS:
\item \code{sample}: An identifying field for your samples; either in the INFO field or as the header to the FORMAT field.
\item \code{SVTYPE}: Structural variant types; INV DUP DEL INS FUS.
\item \code{SVLEN}: Length of the structural variant in base pairs.
}}

\item{vaf_cutoff}{Add \code{is_germline} column that identifies ostensibly germline variants using
a cutoff for variant allele fraction (VAF). There is no default value provided,
but generally a value of 0.1 (i.e., 10\%) is a good starting point. Setting this
flag variants that are present at a frequency greater than this value
at a given site.}

\item{sample_data_file}{An optional file containing additional sample metadata
(dose, timepoint, etc.)}

\item{sd_sep}{The delimiter for importing sample metadata tables. Default is tab-delimited}

\item{regions}{"human", "mouse", "rat" , or "custom". The argument refers to the
TS Mutagenesis panel of the specified species, or to a custom panel.
If custom, provide the file path in custom_regions_file and the genome assembly version.}

\item{custom_regions_file}{"filepath". If regions is set to custom,
provide the file path for the file containing regions metadata.
Required columns are "contig", "start", and "end"}

\item{rg_sep}{The delimiter for importing the custom_regions_file. Default is tab-delimited}

\item{genome}{If a custom regions file is provided, indicate the genome
assembly. For a complete list, refer to https://genome.ucsc.edu
Ex.Human GRCh38 = hg38 | Human GRCh37 = hg19 | Mouse GRCm38 = mm10 |
Mouse GRCm39 = mm39 | Rat RGSC 6.0 = rn6 | Rat mRatBN7.2 = rn7}

\item{depth_calc}{In the instance when there are two or more calls at the
same location within a sample, and the depths differ, this parameter chooses
the method of calculation for the total_depth. take_mean calculates the
total_depth by taking the mean reference depth and then adding all the alt depths.
take_del calculates the total_depth by choosing only the reference depth of
the deletion in the group, or if no deletion is present, the complex variant,
then adding all alt depths. If there is no deletion or complex variant,
it takes the mean of the reference depths. Default is "take_del".}

\item{output_granges}{\code{TRUE} or \code{FALSE}; whether you want the mutation data to
output as a GRanges object. Default output is as a dataframe.}
}
\value{
A data frame or a GRanges object where each row is a mutation, and columns indicate the location, type, and other data.
}
\description{
Imports a .vcf file into the R environment and converts it into a dataframe
}
