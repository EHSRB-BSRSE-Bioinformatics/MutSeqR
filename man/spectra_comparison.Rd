% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spectra_comparison.R
\name{spectra_comparison}
\alias{spectra_comparison}
\title{Compare the overall mutation spectra between groups}
\usage{
spectra_comparison(
  mf_data,
  cols_to_group,
  mf_type = "min",
  contrasts,
  cont_sep = "\\t"
)
}
\arguments{
\item{mf_data}{A data frame containing the MF data. This
is the output from calculate_mf(). MF data should be at the
desired subtype resolution. Data should be calculated for
the same columns as the \code{cols_to_group} argument. Required columns
are the cols_to_group columns, the subtype column, and sum_min or sum_max.}

\item{cols_to_group}{The column names of the variables across which the
mutations were summed. by. Ex. c("dose", "tissue"). This
function will sum the mutations across groups before running the comparison.}

\item{mf_type}{The type of mutation frequency to use. Default is "min".}

\item{contrasts}{a filepath to a tab-delimited \code{.txt} file OR a dataframe that
will specify the comparisons to be made between groups. The table must
consist of two columns. The first column will be a level within your group
column and the second column must be the group level that it will be
compared to. All values must correspond to entries in your \code{cols_to_group}
column. For more than one \code{group} variable, separate the levels of
each group with a colon. Ensure that all \code{groups} listed in cols_to_group
are represented in each entry for the table. See details for examples.}

\item{cont_sep}{The delimiter used to import the contrasts table.
Default is tab.}
}
\value{
the log-likelihood statistic G2 for the specified comparisons with
the p-value adjusted for multiple-comparisons.
}
\description{
spectra_comparison compares the mutation spectra of groups using a
modified contingency table approach.
}
\details{
Examples of \code{contrasts}:
If you have \code{group = "dose"} with dose groups 0, 25, 50, 100. The first
column would contain the treated groups (25, 50, 100), while the second
column would be 0, thus comparing each treated group to the control group.

25 0

50 0

100 0

Ex. Consider two grouping variables \code{group = c("dose", "tissue")};
with levels dose (0, 25, 50, 100) and tissue("bone_marrow", "liver").
To compare the mutation spectra between tissues for each dose group,
the contrast table would look like:

0:bone_marrow	0:liver

25:bone_marrow	25:liver

50:bone_marrow	50:liver

100:bone_marrow 100:liver
}
\examples{
example_file <- system.file("extdata", "example_mutation_data_filtered.rds", package = "MutSeqR")
example_data <- readRDS(example_file)

# Example: compare 6-base mutation spectra between dose groups

# Calculate the mutation frequency data at the 6-base resolution
mf_data <- calculate_mf(mutation_data = example_data,
                        cols_to_group = "dose_group",
                         subtype_resolution = "base_6")
# Create the contrasts table
contrasts <- data.frame(col1 = c("Low", "Medium", "High"),
                        col2 = rep("Control", 3))
# Run the comparison
spectra_comparison(mf_data = mf_data,
                   cols_to_group = "dose_group",
                   mf_type = "min",
                   contrasts = contrasts)
}
