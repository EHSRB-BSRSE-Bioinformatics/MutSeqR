% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/linear_modelling.R
\name{model_mf}
\alias{model_mf}
\title{Perform linear modelling on mutation frequency for given
fixed and random effects}
\usage{
model_mf(
  mf_data,
  fixed_effects = c("dose", "label"),
  test_interaction = TRUE,
  random_effects = "sample",
  reference_level = c(0, "chr1"),
  muts = "sample_label_sum_unique",
  total_count = "sample_label_group_depth",
  contrast_table_file = NULL
)
}
\arguments{
\item{mf_data}{The data frame containing the mutation frequency data.
Mutation counts and total sequencing depth should be summarized per sample
alongside columns for your fixed effects.
This data can be obtained using \code{calculate_mut_freq( summary = TRUE)}.}

\item{fixed_effects}{The name(s) of the column(s) that will act as the
fixed effect (factor/independent variable) for modelling mutation frequency.
Fixed effects are variables that have a direct and constant effect on the
dependent variable (ie mutation frequency).They are typically the experimental
factors or covariates of interest for their impact on the dependent variable.
One or more fixed effect may be provided. If you are providing more than one
fixed effect, avoid using correlated variables; each fixed effect must
independently predict the dependent variable.

Ex. \code{fixed_effects = c("dose", "genomic_target", "tissue", "age", etc)}.}

\item{test_interaction}{\code{TRUE} or \code{FALSE}. Whether or not your model should include
the interaction between the fixed_effects. Interaction terms enable you to
examine whether the relationship between the dependent and independent
variable changes based on the value of another independent variable.
In other words, if an interaction is significant, then the relationship
between the fixed effects is not constant across all levels of each variable.

Ex. Consider investigating the effect of dose group and tissue on mutation
frequency. An interaction between dose and tissue would capture whether the
dose response differs between tissues.}

\item{random_effects}{The name of the column(s) to be analysed as a
random effect in the model. Providing this effect will cause the function to
fit a generalized linear mixed-effects model. Random effects account for the
unmeasured sources of statistical variance that affect certain groups in the
data. They help account for unobserved heterogeneity or correlation within groups.

Ex. If your model uses repeated measures within a sample, \code{random_effects = "sample"}.}

\item{reference_level}{Refers to one of the levels within each of your
fixed_effects. The coefficient for the reference level will represent the
baseline effect. The coefficients of the other levels will be interpreted in
relation to the reference_level as deviations from the baseline effect.
Setting a reference level for your fixed effects enhances the interpretability
of the model.

Ex. Consider a fixed effect "dose" with levels 0, 25, 50, and 100 mg/kg.
Intuitively, the reference_level would refer to the  negative control dose, "0"
since we are interested in testing how the treatment might change mutation
frequency relative to the control.}

\item{muts}{The column containing the mutation count per sample.}

\item{total_count}{The column containing the sequencing depth per sample.}

\item{contrast_table_file}{a filepath to a tab-delimited \code{.txt} file that will
provide the information necessary to make pariwise comparisons between groups.
The table must consist of two columns. The first column will be a group within
your fixed_effects and the second column must be the group that it will be
compared to.  The values must correspond to entries in your
mf_data column for each fixed effect. Put the group that you expect to have the higher
mutation frequency in the 1st column and the group that you expect to have a
lower mutation frequency in the second column.

For example, if you have a fixed effect "dose" with dose groups 0, 25, 50, 100,
then the first column would contain the treated groups (25, 50, 100), while
the second column would be 0, thus comparing each treated group to the control group.

25 0

50 0

100 0

Alternatively, if you would like to compare mutation frequency between treated
dose groups, then the contrast table would look as follows, with the lower
dose always in the second column, as we expect it to have a lower mutation
frequency.

100 25

100 50

50 25

For multiple fixed effects, separate the levels of each fixed-effect
of a group with a colon. Ensure that all fixed_effects are represented in
each entry for the table. Consider the scenario where the fixed effects
are "dose" (0, 25, 50, 100) and "genomic_target" ("chr1", "chr2"). To compare
the three treated dose groups to the control for each genomic target, then the
contrast table would look like:

25:chr1    0:chr1

50:chr1    0:chr1

100:chr1    0:chr1

25:chr2    0:chr2

50:chr2    0:chr2

100:chr2    0:chr2}
}
\value{
Model results are output as a list. Included are:
\itemize{
\item model_data: the supplied mf_data with added column for model residuals.
\item summary: the summary of the model.
\item anova: the results of Anova(model).
\item residuals_histogram: the model residuals plotted as a histogram.
\item residuals_qq_plot: the model residuals plotted in a qq-plot.
\item point_estimates_matrix: the contrast matrix used to generate point-estimates for the fixed effects.
\item point_estimates: the point estimates for the fixed effects.
\item pairwise_comparisons_matrix: the contrast matrix used to conduct the pairwise comparisons specified in the \code{contrast_table_file}.
\item pairwise_comparisons: the results of pairwise comparisons specified in the \code{contrast_table_file}.
}
}
\description{
\code{model_mf} will fit a generalized linear model or a generalized linear
mixed-effects model to analyse the effect(s) of given factor(s) on
mutation frequency.
}
